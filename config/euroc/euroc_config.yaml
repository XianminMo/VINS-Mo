%YAML:1.0

#common parameters
imu_topic: "/imu0"
image_topic: "/cam0/image_raw"
output_path: "/home/linux/mxm/output/mh05"
depth_model_path: "/home/linux/mxm/proj/VINS-Mo/src/VINS-Mo/vins_estimator/models/Midas-V2.onnx" # path to depth estimation model
use_fast_init: 1      # 0: normal initialization; 1: use fast initialization with depth estimation

# fast init parameters (optional; defaults used if omitted)
fast_init.min_features: 50                 # 最小特征数阈值（初始化前检测）
fast_init.min_acc_var: 0.15               # IMU加速度方差下限，用于激励检测（无单位）
fast_init.ransac.min_measurements: 4      # RANSAC最小观测对数量
fast_init.ransac.max_iterations: 500      # RANSAC最大迭代次数
fast_init.ransac.residual_thresh_px: 0.01 # RANSAC残差阈值（像素）
fast_init.ransac.min_inliers: 20          # RANSAC最少内点数
fast_init.ransac.early_exit_inlier_ratio: 0.6 # 早停：内点比例超过该值即提前退出
fast_init.svd.min_sigma: 1.0e-8           # SVD最小奇异值阈值（数值稳定性）
fast_init.cond.threshold: 1.0e6           # 线性系统条件数上限（数值稳定性）
fast_init.depth.inv_min: 1.0e-6           # 归一化逆深度最小值（有效性检查）
fast_init.depth.inv_max: 10.0             # 归一化逆深度最大值（有效性检查）
fast_init.depth.z_min: 0.1                # 有效景深下限（米）
fast_init.depth.z_max: 50.0               # 有效景深上限（米）
fast_init.depth.min_valid_features: 10    # 有效深度特征的最少数量
fast_init.irls.iters: 3                   # IRLS迭代次数
fast_init.irls.huber_delta: 1.5e-2        # IRLS Huber阈值（像面误差尺度）
fast_init.reg.lambda_a: 1.0e-2            # 正则：尺度因子a的权重
fast_init.reg.lambda_b: 5.0e-3            # 正则：深度偏移b的权重
fast_init.reg.lambda_v: 1.0e-3            # 正则：初始速度v的权重


#camera calibration 
model_type: PINHOLE
camera_name: camera
image_width: 752
image_height: 480
distortion_parameters:
   k1: -2.917e-01
   k2: 8.228e-02
   p1: 5.333e-05
   p2: -1.578e-04
projection_parameters:
   fx: 4.616e+02
   fy: 4.603e+02
   cx: 3.630e+02
   cy: 2.481e+02

# Extrinsic parameter between IMU and Camera.
estimate_extrinsic: 0   # 0  Have an accurate extrinsic parameters. We will trust the following imu^R_cam, imu^T_cam, don't change it.
                        # 1  Have an initial guess about extrinsic parameters. We will optimize around your initial guess.
                        # 2  Don't know anything about extrinsic parameters. You don't need to give R,T. We will try to calibrate it. Do some rotation movement at beginning.                        
#If you choose 0 or 1, you should write down the following matrix.
#Rotation from camera frame to imu frame, imu^R_cam
extrinsicRotation: !!opencv-matrix
   rows: 3
   cols: 3
   dt: d
   data: [0.0148655429818, -0.999880929698, 0.00414029679422,
           0.999557249008, 0.0149672133247, 0.025715529948, 
           -0.0257744366974, 0.00375618835797, 0.999660727178]
#Translation from camera frame to imu frame, imu^T_cam
extrinsicTranslation: !!opencv-matrix
   rows: 3
   cols: 1
   dt: d
   data: [-0.0216401454975,-0.064676986768, 0.00981073058949]

#feature traker paprameters
max_cnt: 150            # max feature number in feature tracking
min_dist: 30            # min distance between two features 
freq: 10                # frequence (Hz) of publish tracking result. At least 10Hz for good estimation. If set 0, the frequence will be same as raw image 
F_threshold: 1.0        # ransac threshold (pixel)
show_track: 1           # publish tracking image as topic
equalize: 1             # if image is too dark or light, trun on equalize to find enough features
fisheye: 0              # if using fisheye, trun on it. A circle mask will be loaded to remove edge noisy points

#optimization parameters
max_solver_time: 0.04  # max solver itration time (ms), to guarantee real time
max_num_iterations: 8   # max solver itrations, to guarantee real time
keyframe_parallax: 10.0 # keyframe selection threshold (pixel)

#imu parameters       The more accurate parameters you provide, the better performance
acc_n: 0.08          # accelerometer measurement noise standard deviation. #0.2   0.04
gyr_n: 0.004         # gyroscope measurement noise standard deviation.     #0.05  0.004
acc_w: 0.00004         # accelerometer bias random work noise standard deviation.  #0.02
gyr_w: 2.0e-6       # gyroscope bias random work noise standard deviation.     #4.0e-5
g_norm: 9.81007     # gravity magnitude

#loop closure parameters
loop_closure: 1                    # start loop closure
load_previous_pose_graph: 0        # load and reuse previous pose graph; load from 'pose_graph_save_path'
fast_relocalization: 0             # useful in real-time and large project
pose_graph_save_path: "/home/linux/mxm/output/pose_graph/" # save and load path

#unsynchronization parameters
estimate_td: 0                      # online estimate time offset between camera and imu
td: 0.0                             # initial value of time offset. unit: s. readed image clock + td = real image clock (IMU clock)

#rolling shutter parameters
rolling_shutter: 0                  # 0: global shutter camera, 1: rolling shutter camera
rolling_shutter_tr: 0               # unit: s. rolling shutter read out time per frame (from data sheet). 

#visualization parameters
save_image: 1                   # save image in pose graph for visualization prupose; you can close this function by setting 0 
visualize_imu_forward: 0        # output imu forward propogation to achieve low latency and high frequence results
visualize_camera_size: 0.4      # size of camera marker in RVIZ
